<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React Bundleless Playground</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .playground {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 968px) {
            .playground {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            background: #2d3748;
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-content {
            flex: 1;
            padding: 0;
            overflow: auto;
        }

        .editor {
            width: 100%;
            height: 500px;
            border: none;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            padding: 20px;
            resize: vertical;
            background: #1e1e1e;
            color: #d4d4d4;
            line-height: 1.6;
        }

        .preview {
            min-height: 500px;
            padding: 20px;
            background: #f7fafc;
        }

        .controls {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #48bb78;
            color: white;
        }

        .btn-secondary:hover {
            background: #38a169;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(72, 187, 120, 0.4);
        }

        .btn-danger {
            background: #f56565;
            color: white;
        }

        .btn-danger:hover {
            background: #e53e3e;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(245, 101, 101, 0.4);
        }

        .error {
            background: #fff5f5;
            border: 2px solid #fc8181;
            border-radius: 8px;
            padding: 15px;
            color: #c53030;
            margin: 20px;
            font-family: monospace;
            white-space: pre-wrap;
        }

        .examples {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .example-btn {
            padding: 8px 16px;
            background: #edf2f7;
            color: #2d3748;
            border: 2px solid #cbd5e0;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .example-btn:hover {
            background: #e2e8f0;
            border-color: #a0aec0;
        }

        .status {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
        }

        .status.success {
            background: #c6f6d5;
            color: #22543d;
        }

        .status.error {
            background: #fed7d7;
            color: #742a2a;
        }

        .modules-panel {
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-top: 20px;
            overflow: hidden;
        }

        .modules-list {
            padding: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .module-item {
            padding: 12px;
            background: #f7fafc;
            border-left: 4px solid #667eea;
            margin-bottom: 10px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
        }

        .module-name {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 4px;
        }

        .module-url {
            color: #718096;
            font-size: 12px;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ React Bundleless Playground</h1>
            <p>åœ¨æµè§ˆå™¨ä¸­ç›´æ¥ç¼–å†™å’Œè¿è¡Œ React ä»£ç ï¼Œæ— éœ€æ„å»ºå·¥å…·</p>
        </div>

        <div class="playground">
            <div class="panel">
                <div class="panel-header">
                    <span>ğŸ“ JSX ä»£ç ç¼–è¾‘å™¨</span>
                    <span id="lineCount" style="opacity: 0.7; font-size: 12px;">è¡Œæ•°: 0</span>
                </div>
                <div class="panel-content">
                    <textarea id="editor" class="editor" spellcheck="false"></textarea>
                </div>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <span>ğŸ‘ï¸ å®æ—¶é¢„è§ˆ</span>
                    <span id="status" class="status"></span>
                </div>
                <div class="panel-content">
                    <div id="preview" class="preview"></div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn-primary" onclick="runCode()">
                â–¶ï¸ è¿è¡Œä»£ç 
            </button>
            <button class="btn-secondary" onclick="downloadHTML()">
                ğŸ’¾ ä¸‹è½½ HTML
            </button>
            <button class="btn-danger" onclick="clearCode()">
                ğŸ—‘ï¸ æ¸…ç©º
            </button>

            <div style="flex: 1;"></div>

            <div style="display: flex; align-items: center; gap: 10px;">
                <label style="color: white; font-weight: 600;">é€‰æ‹©é¡µé¢:</label>
                <select
                    id="pagePathSelect"
                    style="padding: 8px 16px; border: 2px solid #cbd5e0; border-radius: 6px; font-size: 14px; min-width: 200px; cursor: pointer;"
                    onchange="loadBundlelessPageByPath()"
                >
                    <option value="">-- é€‰æ‹©é¡µé¢ --</option>
                    <option value="index">/index</option>
                    <option value="home">/home</option>
                    <option value="register">/register</option>
                </select>
            </div>
        </div>

        <div class="modules-panel">
            <div class="panel-header">
                <span>ğŸ“¦ åŠ è½½çš„æ¨¡å—</span>
                <span id="moduleCount" style="opacity: 0.7; font-size: 12px;">0 ä¸ªæ¨¡å—</span>
            </div>
            <div id="modulesList" class="modules-list">
                <p style="text-align: center; color: #a0aec0;">é€‰æ‹©ä¸€ä¸ªé¡µé¢æŸ¥çœ‹å…¶åŠ è½½çš„æ¨¡å—</p>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡ï¼Œç”¨äºç®¡ç† React root
        let currentRoot = null;

        // æ¨¡å—ä¿¡æ¯
        const pageModules = {
            index: [
                { name: 'React', url: 'https://unpkg.com/react@18/umd/react.development.js', type: 'UMD' },
                { name: 'ReactDOM', url: 'https://unpkg.com/react-dom@18/umd/react-dom.development.js', type: 'UMD' },
                { name: 'Babel Standalone', url: 'https://unpkg.com/@babel/standalone/babel.min.js', type: 'Compiler' },
                { name: 'Tailwind CSS', url: 'https://cdn.tailwindcss.com', type: 'CSS Framework' }
            ],
            home: [
                { name: 'React', url: 'https://unpkg.com/react@18/umd/react.development.js', type: 'UMD' },
                { name: 'ReactDOM', url: 'https://unpkg.com/react-dom@18/umd/react-dom.development.js', type: 'UMD' },
                { name: 'Babel Standalone', url: 'https://unpkg.com/@babel/standalone/babel.min.js', type: 'Compiler' },
                { name: 'Tailwind CSS', url: 'https://cdn.tailwindcss.com', type: 'CSS Framework' }
            ],
            register: [
                { name: 'React', url: 'https://unpkg.com/react@18/umd/react.development.js', type: 'UMD' },
                { name: 'ReactDOM', url: 'https://unpkg.com/react-dom@18/umd/react-dom.development.js', type: 'UMD' },
                { name: 'Babel Standalone', url: 'https://unpkg.com/@babel/standalone/babel.min.js', type: 'Compiler' },
                { name: 'Tailwind CSS', url: 'https://cdn.tailwindcss.com', type: 'CSS Framework' }
            ]
        };

        // Bundleless é¡µé¢ä»£ç 
        const bundlelessPages = {
            index: `function Home() {
  return (
    <div className="flex min-h-screen items-center justify-center bg-zinc-50 font-sans dark:bg-black">
      <main className="flex min-h-screen w-full max-w-3xl flex-col items-center justify-between py-32 px-16 bg-white dark:bg-black sm:items-start">
        <svg className="dark:invert" width="180" height="37" viewBox="0 0 180 37" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M25.5 0L51 36H0L25.5 0Z" fill="black"/>
          <text x="60" y="28" fontFamily="system-ui, -apple-system" fontSize="24" fontWeight="bold" fill="black">Next.js</text>
        </svg>
        <div className="flex flex-col items-center gap-6 text-center sm:items-start sm:text-left">
          <h1 className="max-w-xs text-3xl font-semibold leading-10 tracking-tight text-black dark:text-zinc-50">
            To get started, edit the page.tsx file.
          </h1>
          <p className="max-w-md text-lg leading-8 text-zinc-600 dark:text-zinc-400">
            Looking for a starting point or more instructions? Head over to{" "}
            <a
              href="https://vercel.com/templates?framework=next.js"
              className="font-medium text-zinc-950 dark:text-zinc-50"
            >
              Templates
            </a>{" "}
            or the{" "}
            <a
              href="https://nextjs.org/learn"
              className="font-medium text-zinc-950 dark:text-zinc-50"
            >
              Learning
            </a>{" "}
            center.
          </p>
        </div>
        <div className="flex flex-col gap-4 text-base font-medium sm:flex-row">
          <a
            className="flex h-12 w-full items-center justify-center gap-2 rounded-full bg-black px-5 text-white transition-colors hover:bg-gray-800 dark:bg-white dark:text-black dark:hover:bg-gray-200 md:w-[158px]"
            href="https://vercel.com/new"
            target="_blank"
            rel="noopener noreferrer"
          >
            Deploy Now
          </a>
          <a
            className="flex h-12 w-full items-center justify-center rounded-full border border-solid border-black/[.08] px-5 transition-colors hover:border-transparent hover:bg-black/[.04] dark:border-white/[.145] dark:hover:bg-[#1a1a1a] md:w-[158px]"
            href="https://nextjs.org/docs"
            target="_blank"
            rel="noopener noreferrer"
          >
            Documentation
          </a>
        </div>
      </main>
    </div>
  );
}

ReactDOM.render(<Home />, document.getElementById('preview'));`,

            home: `function HomePage() {
  return (
    <div className="flex min-h-screen items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800">
      <main className="text-center">
        <h1 className="text-6xl font-bold text-gray-900 dark:text-white mb-4">
          Hello World
        </h1>
        <p className="text-xl text-gray-600 dark:text-gray-300">
          Welcome to Next.js 16!
        </p>
      </main>
    </div>
  );
}

ReactDOM.render(<HomePage />, document.getElementById('preview'));`,

            register: `function Register() {
  return (
    <div className="flex min-h-screen items-center justify-center bg-zinc-50 dark:bg-black">
      <div className="w-full max-w-md space-y-8 rounded-lg bg-white p-8 shadow-lg dark:bg-zinc-900">
        <div>
          <h2 className="text-center text-3xl font-bold tracking-tight text-zinc-900 dark:text-zinc-50">
            Create your account
          </h2>
          <p className="mt-2 text-center text-sm text-zinc-600 dark:text-zinc-400">
            Already have an account?{" "}
            <a href="/login" className="font-medium text-zinc-900 hover:text-zinc-700 dark:text-zinc-50 dark:hover:text-zinc-300">
              Sign in
            </a>
          </p>
        </div>
        <form className="mt-8 space-y-6" action="#" method="POST">
          <div className="space-y-4">
            <div>
              <label htmlFor="name" className="block text-sm font-medium text-zinc-900 dark:text-zinc-50">
                Full Name
              </label>
              <input
                id="name"
                name="name"
                type="text"
                required
                className="mt-1 block w-full rounded-md border border-zinc-300 px-3 py-2 text-zinc-900 placeholder-zinc-400 focus:border-zinc-500 focus:outline-none focus:ring-zinc-500 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-50 dark:placeholder-zinc-500"
                placeholder="John Doe"
              />
            </div>
            <div>
              <label htmlFor="email" className="block text-sm font-medium text-zinc-900 dark:text-zinc-50">
                Email address
              </label>
              <input
                id="email"
                name="email"
                type="email"
                autoComplete="email"
                required
                className="mt-1 block w-full rounded-md border border-zinc-300 px-3 py-2 text-zinc-900 placeholder-zinc-400 focus:border-zinc-500 focus:outline-none focus:ring-zinc-500 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-50 dark:placeholder-zinc-500"
                placeholder="you@example.com"
              />
            </div>
            <div>
              <label htmlFor="password" className="block text-sm font-medium text-zinc-900 dark:text-zinc-50">
                Password
              </label>
              <input
                id="password"
                name="password"
                type="password"
                autoComplete="new-password"
                required
                className="mt-1 block w-full rounded-md border border-zinc-300 px-3 py-2 text-zinc-900 placeholder-zinc-400 focus:border-zinc-500 focus:outline-none focus:ring-zinc-500 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-50 dark:placeholder-zinc-500"
                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              />
            </div>
            <div>
              <label htmlFor="confirm-password" className="block text-sm font-medium text-zinc-900 dark:text-zinc-50">
                Confirm Password
              </label>
              <input
                id="confirm-password"
                name="confirm-password"
                type="password"
                autoComplete="new-password"
                required
                className="mt-1 block w-full rounded-md border border-zinc-300 px-3 py-2 text-zinc-900 placeholder-zinc-400 focus:border-zinc-500 focus:outline-none focus:ring-zinc-500 dark:border-zinc-700 dark:bg-zinc-800 dark:text-zinc-50 dark:placeholder-zinc-500"
                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              />
            </div>
          </div>

          <div>
            <button
              type="submit"
              className="flex w-full justify-center rounded-md bg-zinc-900 px-3 py-2 text-sm font-semibold text-white hover:bg-zinc-700 focus:outline-none focus:ring-2 focus:ring-zinc-500 focus:ring-offset-2 dark:bg-zinc-50 dark:text-zinc-900 dark:hover:bg-zinc-200"
            >
              Register
            </button>
          </div>
        </form>
      </div>
    </div>
  );
}

ReactDOM.render(<Register />, document.getElementById('preview'));`
        };

        // ç¤ºä¾‹ä»£ç 
        const examples = {
            counter: "function Counter() {\n  const [count, setCount] = React.useState(0);\n\n  return (\n    <div style={{ padding: '20px', textAlign: 'center' }}>\n      <h2 style={{ color: '#2d3748', marginBottom: '20px' }}>\n        è®¡æ•°å™¨ç¤ºä¾‹\n      </h2>\n      <div style={{\n        fontSize: '48px',\n        fontWeight: 'bold',\n        color: '#667eea',\n        margin: '20px 0'\n      }}>\n        {count}\n      </div>\n      <div style={{ display: 'flex', gap: '10px', justifyContent: 'center' }}>\n        <button\n          onClick={() => setCount(count - 1)}\n          style={{\n            padding: '10px 20px',\n            fontSize: '16px',\n            background: '#f56565',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            cursor: 'pointer'\n          }}\n        >\n          - å‡å°‘\n        </button>\n        <button\n          onClick={() => setCount(0)}\n          style={{\n            padding: '10px 20px',\n            fontSize: '16px',\n            background: '#718096',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            cursor: 'pointer'\n          }}\n        >\n          é‡ç½®\n        </button>\n        <button\n          onClick={() => setCount(count + 1)}\n          style={{\n            padding: '10px 20px',\n            fontSize: '16px',\n            background: '#48bb78',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            cursor: 'pointer'\n          }}\n        >\n          + å¢åŠ \n        </button>\n      </div>\n    </div>\n  );\n}\n\nReactDOM.render(<Counter />, document.getElementById('preview'));",

            todo: "function TodoApp() {\n  const [todos, setTodos] = React.useState([]);\n  const [input, setInput] = React.useState('');\n\n  const addTodo = () => {\n    if (input.trim()) {\n      setTodos([...todos, { id: Date.now(), text: input, done: false }]);\n      setInput('');\n    }\n  };\n\n  const toggleTodo = (id) => {\n    setTodos(todos.map(todo =>\n      todo.id === id ? { ...todo, done: !todo.done } : todo\n    ));\n  };\n\n  const deleteTodo = (id) => {\n    setTodos(todos.filter(todo => todo.id !== id));\n  };\n\n  return (\n    <div style={{ padding: '20px', maxWidth: '500px', margin: '0 auto' }}>\n      <h2 style={{ color: '#2d3748', marginBottom: '20px' }}>\n        ğŸ“ å¾…åŠäº‹é¡¹\n      </h2>\n\n      <div style={{ display: 'flex', gap: '10px', marginBottom: '20px' }}>\n        <input\n          type=\"text\"\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          onKeyPress={(e) => e.key === 'Enter' && addTodo()}\n          placeholder=\"æ·»åŠ æ–°ä»»åŠ¡...\"\n          style={{\n            flex: 1,\n            padding: '10px',\n            fontSize: '14px',\n            border: '2px solid #e2e8f0',\n            borderRadius: '8px'\n          }}\n        />\n        <button\n          onClick={addTodo}\n          style={{\n            padding: '10px 20px',\n            background: '#667eea',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            cursor: 'pointer'\n          }}\n        >\n          æ·»åŠ \n        </button>\n      </div>\n\n      <div>\n        {todos.map(todo => (\n          <div\n            key={todo.id}\n            style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: '10px',\n              padding: '12px',\n              background: 'white',\n              borderRadius: '8px',\n              marginBottom: '8px',\n              border: '1px solid #e2e8f0'\n            }}\n          >\n            <input\n              type=\"checkbox\"\n              checked={todo.done}\n              onChange={() => toggleTodo(todo.id)}\n              style={{ cursor: 'pointer' }}\n            />\n            <span style={{\n              flex: 1,\n              textDecoration: todo.done ? 'line-through' : 'none',\n              color: todo.done ? '#a0aec0' : '#2d3748'\n            }}>\n              {todo.text}\n            </span>\n            <button\n              onClick={() => deleteTodo(todo.id)}\n              style={{\n                padding: '5px 10px',\n                background: '#f56565',\n                color: 'white',\n                border: 'none',\n                borderRadius: '6px',\n                cursor: 'pointer',\n                fontSize: '12px'\n              }}\n            >\n              åˆ é™¤\n            </button>\n          </div>\n        ))}\n      </div>\n\n      {todos.length === 0 && (\n        <p style={{ textAlign: 'center', color: '#a0aec0', marginTop: '20px' }}>\n          æš‚æ— ä»»åŠ¡ï¼Œæ·»åŠ ä¸€ä¸ªå¼€å§‹å§ï¼\n        </p>\n      )}\n    </div>\n  );\n}\n\nReactDOM.render(<TodoApp />, document.getElementById('preview'));",

            form: "function ContactForm() {\n  const [formData, setFormData] = React.useState({\n    name: '',\n    email: '',\n    message: ''\n  });\n  const [submitted, setSubmitted] = React.useState(false);\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setSubmitted(true);\n    setTimeout(() => {\n      setSubmitted(false);\n      setFormData({ name: '', email: '', message: '' });\n    }, 3000);\n  };\n\n  return (\n    <div style={{ padding: '20px', maxWidth: '500px', margin: '0 auto' }}>\n      <h2 style={{ color: '#2d3748', marginBottom: '20px' }}>\n        ğŸ“® è”ç³»è¡¨å•\n      </h2>\n\n      {submitted ? (\n        <div style={{\n          padding: '20px',\n          background: '#c6f6d5',\n          color: '#22543d',\n          borderRadius: '8px',\n          textAlign: 'center'\n        }}>\n          âœ… è¡¨å•æäº¤æˆåŠŸï¼\n        </div>\n      ) : (\n        <form onSubmit={handleSubmit}>\n          <div style={{ marginBottom: '15px' }}>\n            <label style={{ display: 'block', marginBottom: '5px', color: '#2d3748', fontWeight: '600' }}>\n              å§“å\n            </label>\n            <input\n              type=\"text\"\n              name=\"name\"\n              value={formData.name}\n              onChange={handleChange}\n              required\n              style={{\n                width: '100%',\n                padding: '10px',\n                fontSize: '14px',\n                border: '2px solid #e2e8f0',\n                borderRadius: '8px'\n              }}\n            />\n          </div>\n\n          <div style={{ marginBottom: '15px' }}>\n            <label style={{ display: 'block', marginBottom: '5px', color: '#2d3748', fontWeight: '600' }}>\n              é‚®ç®±\n            </label>\n            <input\n              type=\"email\"\n              name=\"email\"\n              value={formData.email}\n              onChange={handleChange}\n              required\n              style={{\n                width: '100%',\n                padding: '10px',\n                fontSize: '14px',\n                border: '2px solid #e2e8f0',\n                borderRadius: '8px'\n              }}\n            />\n          </div>\n\n          <div style={{ marginBottom: '15px' }}>\n            <label style={{ display: 'block', marginBottom: '5px', color: '#2d3748', fontWeight: '600' }}>\n              ç•™è¨€\n            </label>\n            <textarea\n              name=\"message\"\n              value={formData.message}\n              onChange={handleChange}\n              required\n              rows=\"4\"\n              style={{\n                width: '100%',\n                padding: '10px',\n                fontSize: '14px',\n                border: '2px solid #e2e8f0',\n                borderRadius: '8px',\n                resize: 'vertical'\n              }}\n            />\n          </div>\n\n          <button\n            type=\"submit\"\n            style={{\n              width: '100%',\n              padding: '12px',\n              background: '#667eea',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              fontSize: '16px',\n              fontWeight: '600',\n              cursor: 'pointer'\n            }}\n          >\n            æäº¤\n          </button>\n        </form>\n      )}\n    </div>\n  );\n}\n\nReactDOM.render(<ContactForm />, document.getElementById('preview'));",

            fetch: "function DataFetcher() {\n  const [data, setData] = React.useState(null);\n  const [loading, setLoading] = React.useState(false);\n  const [error, setError] = React.useState(null);\n\n  const fetchData = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await fetch('https://api.github.com/users/github');\n      const json = await response.json();\n      setData(json);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div style={{ padding: '20px', maxWidth: '500px', margin: '0 auto' }}>\n      <h2 style={{ color: '#2d3748', marginBottom: '20px' }}>\n        ğŸŒ æ•°æ®è·å–ç¤ºä¾‹\n      </h2>\n\n      <button\n        onClick={fetchData}\n        disabled={loading}\n        style={{\n          width: '100%',\n          padding: '12px',\n          background: loading ? '#a0aec0' : '#667eea',\n          color: 'white',\n          border: 'none',\n          borderRadius: '8px',\n          fontSize: '16px',\n          fontWeight: '600',\n          cursor: loading ? 'not-allowed' : 'pointer',\n          marginBottom: '20px'\n        }}\n      >\n        {loading ? 'åŠ è½½ä¸­...' : 'è·å– GitHub ç”¨æˆ·ä¿¡æ¯'}\n      </button>\n\n      {error && (\n        <div style={{\n          padding: '15px',\n          background: '#fed7d7',\n          color: '#742a2a',\n          borderRadius: '8px',\n          marginBottom: '20px'\n        }}>\n          é”™è¯¯: {error}\n        </div>\n      )}\n\n      {data && (\n        <div style={{\n          padding: '20px',\n          background: 'white',\n          borderRadius: '8px',\n          border: '1px solid #e2e8f0'\n        }}>\n          <img\n            src={data.avatar_url}\n            alt={data.login}\n            style={{\n              width: '100px',\n              height: '100px',\n              borderRadius: '50%',\n              marginBottom: '15px'\n            }}\n          />\n          <h3 style={{ color: '#2d3748', marginBottom: '10px' }}>\n            {data.name}\n          </h3>\n          <p style={{ color: '#718096', marginBottom: '5px' }}>\n            @{data.login}\n          </p>\n          <p style={{ color: '#4a5568', marginBottom: '10px' }}>\n            {data.bio}\n          </p>\n          <div style={{ display: 'flex', gap: '20px', marginTop: '15px' }}>\n            <div>\n              <strong>{data.public_repos}</strong>\n              <div style={{ fontSize: '12px', color: '#718096' }}>ä»“åº“</div>\n            </div>\n            <div>\n              <strong>{data.followers}</strong>\n              <div style={{ fontSize: '12px', color: '#718096' }}>å…³æ³¨è€…</div>\n            </div>\n            <div>\n              <strong>{data.following}</strong>\n              <div style={{ fontSize: '12px', color: '#718096' }}>å…³æ³¨ä¸­</div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nReactDOM.render(<DataFetcher />, document.getElementById('preview'));"
        };

        // åˆå§‹åŒ–ç¼–è¾‘å™¨
        const editor = document.getElementById('editor');
        const preview = document.getElementById('preview');
        const status = document.getElementById('status');
        const lineCount = document.getElementById('lineCount');

        // åŠ è½½é»˜è®¤ç¤ºä¾‹
        loadExample('counter');

        // æ›´æ–°è¡Œæ•°
        editor.addEventListener('input', () => {
            const lines = editor.value.split('\n').length;
            lineCount.textContent = 'è¡Œæ•°: ' + lines;
        });

        // åŠ è½½ç¤ºä¾‹
        function loadExample(name) {
            editor.value = examples[name];
            const lines = editor.value.split('\n').length;
            lineCount.textContent = 'è¡Œæ•°: ' + lines;
            runCode();
        }

        // æ˜¾ç¤ºæ¨¡å—ä¿¡æ¯
        function displayModules(pageName) {
            const modulesList = document.getElementById('modulesList');
            const moduleCount = document.getElementById('moduleCount');
            const modules = pageModules[pageName] || [];

            if (modules.length === 0) {
                modulesList.innerHTML = '<p style="text-align: center; color: #a0aec0;">è¯¥é¡µé¢æ²¡æœ‰åŠ è½½ä»»ä½•æ¨¡å—</p>';
                moduleCount.textContent = '0 ä¸ªæ¨¡å—';
                return;
            }

            moduleCount.textContent = modules.length + ' ä¸ªæ¨¡å—';
            modulesList.innerHTML = modules.map(module => `
                <div class="module-item">
                    <div class="module-name">${module.name} <span style="background: #667eea; color: white; padding: 2px 8px; border-radius: 4px; font-size: 11px; margin-left: 8px;">${module.type}</span></div>
                    <div class="module-url">${module.url}</div>
                </div>
            `).join('');
        }

        // åŠ è½½ Bundleless é¡µé¢
        function loadBundlelessPage(pageName) {
            if (bundlelessPages[pageName]) {
                editor.value = bundlelessPages[pageName];
                const lines = editor.value.split('\n').length;
                lineCount.textContent = 'è¡Œæ•°: ' + lines;
                displayModules(pageName);
                runCode();
            }
        }

        // é€šè¿‡è·¯å¾„åŠ è½½ Bundleless é¡µé¢
        function loadBundlelessPageByPath() {
            const pathSelect = document.getElementById('pagePathSelect');
            const path = pathSelect.value;

            // å¦‚æœæ²¡æœ‰é€‰æ‹©é¡µé¢
            if (!path) {
                return;
            }

            // åŠ è½½å¯¹åº”çš„é¡µé¢
            if (bundlelessPages[path]) {
                loadBundlelessPage(path);
                status.className = 'status success';
                status.textContent = 'âœ“ é¡µé¢åŠ è½½æˆåŠŸ';
                setTimeout(() => {
                    status.className = 'status';
                    status.textContent = '';
                }, 2000);
            } else {
                status.className = 'status error';
                status.textContent = 'âœ— é¡µé¢ä¸å­˜åœ¨';
                preview.innerHTML = '<div class="error">âŒ é”™è¯¯:\n\næ‰¾ä¸åˆ°è·¯å¾„ "' + path + '" å¯¹åº”çš„é¡µé¢</div>';
                setTimeout(() => {
                    status.className = 'status';
                    status.textContent = '';
                }, 3000);
            }
        }

        // è¿è¡Œä»£ç 
        function runCode() {
            const code = editor.value;

            // å…ˆæ­£ç¡®å¸è½½æ—§ç»„ä»¶
            if (currentRoot) {
                try {
                    currentRoot.unmount();
                } catch (e) {
                    console.warn('Unmount error:', e);
                }
                currentRoot = null;
            }

            // æ¸…ç©º DOM
            preview.innerHTML = '';

            try {
                // ä¿®æ”¹ç”¨æˆ·ä»£ç ï¼Œä½¿ç”¨ createRoot è€Œä¸æ˜¯ render
                let modifiedCode = code.replace(
                    /ReactDOM\.render\((.*?),\s*document\.getElementById\(['"]preview['"]\)\)/g,
                    function(match, component) {
                        return `currentRoot = ReactDOM.createRoot(document.getElementById('preview')); currentRoot.render(${component})`;
                    }
                );

                // è½¬æ¢ JSX ä¸º JavaScript
                const transformedCode = Babel.transform(modifiedCode, {
                    presets: ['react']
                }).code;

                // æ‰§è¡Œä»£ç 
                eval(transformedCode);

                // æ›´æ–°çŠ¶æ€
                status.className = 'status success';
                status.textContent = 'âœ“ è¿è¡ŒæˆåŠŸ';

                setTimeout(() => {
                    status.className = 'status';
                    status.textContent = '';
                }, 2000);
            } catch (error) {
                preview.innerHTML = '<div class="error">âŒ é”™è¯¯:\n\n' + error.message + '</div>';
                status.className = 'status error';
                status.textContent = 'âœ— è¿è¡Œå¤±è´¥';
                console.error(error);
            }
        }

        // ä¸‹è½½ HTML
        function downloadHTML() {
            const code = editor.value;
            const modifiedCode = code.replace("document.getElementById('preview')", "document.getElementById('root')");
            
            const html = '<!DOCTYPE html>\n' +
'<html lang="zh-CN">\n' +
'<head>\n' +
'    <meta charset="UTF-8">\n' +
'    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n' +
'    <title>React Bundleless App</title>\n' +
'    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"><\/script>\n' +
'    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"><\/script>\n' +
'    <script src="https://unpkg.com/@babel/standalone/babel.min.js"><\/script>\n' +
'</head>\n' +
'<body>\n' +
'    <div id="root"></div>\n' +
'\n' +
'    <script type="text/babel">\n' +
modifiedCode + '\n' +
'    <\/script>\n' +
'</body>\n' +
'</html>';

            const blob = new Blob([html], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'react-app.html';
            a.click();
            URL.revokeObjectURL(url);

            status.className = 'status success';
            status.textContent = 'âœ“ ä¸‹è½½æˆåŠŸ';
            setTimeout(() => {
                status.className = 'status';
                status.textContent = '';
            }, 2000);
        }

        // æ¸…ç©ºä»£ç 
        function clearCode() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºä»£ç å—ï¼Ÿ')) {
                // å…ˆå¸è½½ React ç»„ä»¶
                if (currentRoot) {
                    try {
                        currentRoot.unmount();
                    } catch (e) {
                        console.warn('Unmount error:', e);
                    }
                    currentRoot = null;
                }

                editor.value = '';
                preview.innerHTML = '';
                lineCount.textContent = 'è¡Œæ•°: 0';
            }
        }

        // æ”¯æŒ Ctrl/Cmd + Enter è¿è¡Œ
        editor.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                runCode();
            }
        });
    </script>
</body>
</html>
